<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.equipment.equipmentMapper">
<sql id="phone">
	code, p_name, m_code, p_ap, p_os, p_cpu, p_ram, p_capacity, p_battery
</sql>
<sql id="pc">
	code, pc_name, m_code, pc_division, pc_os, pc_cpu, pc_ram, pc_capacity, pc_gpu
</sql>
<sql id="monitor">
	code, mo_name, m_code, mo_pannel, mo_Hz, mo_resolution, mo_speed, mo_shape
</sql>

<insert id="insertPhone" parameterType="pmap">
	insert into phone (<include refid="phone" />)
	values(#{code}, #{p_name}, #{m_code}, #{p_ap}, #{p_os}, #{p_cpu}, #{p_ram}, #{p_capacity}, #{p_battery})
</insert>

<insert id="insertMonitor" parameterType="pmap">
	insert into monitor (<include refid="monitor" />)
	values(#{code}, #{mo_name}, #{m_code}, #{mo_pannel}, #{mo_Hz}, #{mo_resolution}, #{mo_speed}, #{mo_shape})
</insert>

<insert id="insertPC" parameterType="pmap">
	insert into pc (<include refid="pc" />)
	values(#{code}, #{pc_name}, #{m_code}, #{pc_division}, #{pc_os}, #{pc_cpu}, #{pc_ram}, #{pc_capacity}, #{pc_gpu})
</insert>

<select id="selectEquipments" parameterType="pmap" resultType="pmap">
	select ROWNUM, GUBUN, e.code, m_name as emp, name, ap, cpu, os, ram, capacity, battery, gpu, pannel, hz, resolution, speed, shape, m_code, ma_name as manufacture
	from equipmentView e
	left outer join member mem on mem.code = e.code
	left outer join manufacture ma on ma.ma_code = e.m_code
	where 1=1
	<if test="m_name != null and m_name != '' ">and m_name like '%' || upper(#{m_name}) || '%' or m_name like '%' || lower(#{m_name}) || '%'</if>
	<if test="ma_name != null and ma_name != '' ">and ma_name like '%' || upper(#{ma_name}) || '%' or ma_name like '%' || lower(#{ma_name}) || '%'</if>
	<if test="name != null and name != '' ">and name like '%' || upper(#{name}) || '%' or name like '%' || lower(#{name}) || '%' </if>
	<if test="ap != null and ap != '' ">and ap like '%' || upper(#{ap}) || '%' or ap like '%' || lower(#{ap}) || '%' </if>
	<if test="os != null and os != '' ">and os like '%' || upper(#{os}) || '%' or os like '%' || lower(#{os}) || '%' </if>
	<if test="cpu != null and cpu != '' ">and cpu like '%' || upper(#{cpu}) || '%' or cpu like '%' || lower(#{cpu}) || '%' </if>
	<if test="ram != null and ram != '' ">and ram = #{ram} </if>
	<if test="capacity != null and capacity != '' ">and capacity = #{capacity} </if>
	<if test="battery != null and battery != '' ">and battery = #{battery} </if>
	<if test="gpu != null and gpu != '' ">and gpu like '%' || upper(#{gpu}) || '%' or gpu like '%' || lower(#{gpu}) || '%' </if>
	<if test="pannel != null and pannel != '' ">and pannel like '%' || upper(#{pannel}) || '%' or pannel like '%' || lower(#{pannel}) || '%' </if>
	<if test="hz != null and hz != '' ">and hz = #{hz} </if>
	<if test="resolution != null and resolution != '' ">and resolution like '%' || upper(#{resolution}) || '%' or resolution like '%' || lower(#{resolution}) || '%' </if>
	<if test="speed != null and speed != '' ">and speed = #{speed} </if>
	<if test="gubun != null">and gubun = upper(#{gubun})</if>
</select>

<select id="getInfo" parameterType="pmap" resultType="pmap">
	select * from equipmentView e, member mem, manufacture ma
	where 1=1
	and e.code = mem.code and e.m_code = ma.ma_code
	<if test="code != null">and e.code = #{code}</if>
	<if test="m_code != null">and e.m_code = #{m_code}</if>
	<if test="gubun != null">and gubun = #{gubun} </if>
</select>

<update id="updatePhone" parameterType="pmap">
	update phone
	set
		<if test="p_name != null">
			p_name = #{p_name},
		</if>
		p_ap = #{p_ap},
		p_os = #{p_os},
		p_cpu = #{p_cpu},
		p_ram = #{p_ram},
		p_capacity = #{p_capacity},
		p_battery = #{p_battery}
	where code = #{code}
</update>

<update id="updatePC" parameterType="pmap">
	update pc
	set
		<if test="pc_name != null">
			pc_name = #{p_name},
		</if>
		pc_gpu = #{p_gpu},
		pc_os = #{p_os},
		pc_cpu = #{p_cpu},
		pc_ram = #{p_ram},
		pc_capacity = #{p_capacity}
		
	where code = #{code}
</update>

<update id="updateMonitor" parameterType="pmap">
	update monitor
	set
		<if test="mo_name != null">
			mo_name = #{mo_name},
		</if>
		mo_pannel = #{mo_pannel},
		mo_hz = #{mo_hz},
		mo_resolution = #{mo_resolution},
		mo_speed = #{mo_speed},
		mo_shape = #{mo_shape}
	where code = #{code}
</update>

<delete id="delPhone" parameterType="pmap">
	DELETE FROM phone
	WHERE CODE = #{code} AND M_CODE = #{m_code} 
</delete>

<delete id="delPC" parameterType="pmap">
	DELETE FROM pc
	WHERE CODE = #{code} AND M_CODE = #{m_code} 
</delete>

<delete id="delMonitor" parameterType="pmap">
	DELETE FROM monitor
	WHERE CODE = #{code} AND M_CODE = #{m_code} 
</delete>

<select id="selectEmps" parameterType="pmap" resultType="pmap">
 	select code, m_name, m_depart
 	from member
</select>

<select id="selectManufactures" parameterType="pmap" resultType="pmap">
	select * from manufacture
	where ma_kinds = #{ma_kinds}
</select>

</mapper>